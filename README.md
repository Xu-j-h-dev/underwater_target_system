# æ°´ä¸‹ç›®æ ‡è¯†åˆ«ç³»ç»Ÿ

åŸºäº **Python + PyQt6 + YOLOv11 + MySQL** çš„æ¡Œé¢çº§æ°´ä¸‹ç›®æ ‡è¯†åˆ«ç³»ç»Ÿï¼Œæ”¯æŒå®æ—¶/ç¦»çº¿æ£€æµ‹ã€æ¨¡å‹è®­ç»ƒã€ç”¨æˆ·ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### 1. åŒè§’è‰²ç™»å½•ç³»ç»Ÿ
- æ”¯æŒ **ç®¡ç†å‘˜** å’Œ **æ™®é€šç”¨æˆ·** åŒè§’è‰²
- è´¦å·ç®¡ç†ï¼ˆåˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹å¯†ç ã€è§’è‰²è®¾ç½®ï¼‰
- ç™»å½•æ—¥å¿—è®°å½•

**é»˜è®¤è´¦å·ï¼š**
- ç®¡ç†å‘˜ï¼š`admin` / `admin123`
- æ™®é€šç”¨æˆ·ï¼š`user` / `user123`

### 2. ç®¡ç†å‘˜ä»ªè¡¨ç›˜
- **ç”¨æˆ·ç®¡ç†**ï¼šæŸ¥çœ‹/ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯ã€è§’è‰²ã€çŠ¶æ€
- **æ¨¡å‹ç®¡ç†**ï¼šä¸Šä¼ /åˆ é™¤æ¨¡å‹ã€ç‰ˆæœ¬è®°å½•ã€æ ‡ç­¾è¯´æ˜
- **æ—¥å¿—ç®¡ç†**ï¼šç™»å½•æ—¥å¿—ã€æ¨ç†æ—¥å¿—ã€è®­ç»ƒæ—¥å¿—ã€ç³»ç»Ÿæ—¥å¿—
- æ”¯æŒåˆ†é¡µã€æœç´¢ã€æ’åºã€å¯¼å‡º

### 3. ä¸»ç•Œé¢ï¼ˆæ¨ç†ç•Œé¢ï¼‰
- **æ¨¡å‹åŠ è½½**ï¼šä»æ¨¡å‹ä»“åº“é€‰æ‹© YOLOv11 æƒé‡
- **å‚æ•°è®¾ç½®**ï¼šç½®ä¿¡åº¦é˜ˆå€¼ã€NMS é˜ˆå€¼è°ƒèŠ‚
- **æ•°æ®æºæ”¯æŒ**ï¼š
  - å®æ—¶è§†é¢‘ï¼ˆUSB ç›¸æœº / IP æ‘„åƒå¤´ï¼‰
  - å•å¼ å›¾ç‰‡
  - è§†é¢‘æ–‡ä»¶
- **å¯è§†åŒ–**ï¼šæ£€æµ‹æ¡†ã€ç±»åˆ«ã€ç½®ä¿¡åº¦å®æ—¶æ˜¾ç¤º
- **è¾“å‡º**ï¼šä¿å­˜æ£€æµ‹ç»“æœä¸ºå›¾ç‰‡/è§†é¢‘ï¼Œå¯¼å‡º JSON/TXT
- **æ€§èƒ½æ˜¾ç¤º**ï¼šFPSã€æ¨ç†è€—æ—¶

### 4. æ¨¡å‹è®­ç»ƒç®¡ç†
- æ•°æ®é›†å¯¼å…¥ï¼ˆYOLO æ ¼å¼ï¼‰
- é…ç½®è®­ç»ƒè¶…å‚æ•°ï¼ˆepochsã€batch sizeã€lr ç­‰ï¼‰
- å¯åŠ¨ã€æš‚åœã€ä¸­æ–­è®­ç»ƒä»»åŠ¡
- å®æ—¶ç›‘æ§è®­ç»ƒæ—¥å¿—
- è®­ç»ƒå®Œæˆåè‡ªåŠ¨ä¿å­˜æƒé‡åˆ°æ¨¡å‹ä»“åº“

### 5. æ¨¡å‹ä»“åº“
- å±•ç¤ºæ‰€æœ‰å¯ç”¨ YOLOv11 æ¨¡å‹
- æ¨¡å‹ç‰ˆæœ¬ç®¡ç†
- ä¸€é”®åˆ‡æ¢æ¨¡å‹

### 6. æ—¥å¿—ä¸å‘Šè­¦ä¸­å¿ƒ
- ç™»å½•æ—¥å¿—ã€æ¨ç†æ—¥å¿—ã€è®­ç»ƒæ—¥å¿—
- ç³»ç»Ÿé”™è¯¯å’Œå¼‚å¸¸å‘Šè­¦
- æ”¯æŒå¯¼å‡ºä¸æœç´¢

## ğŸ“ é¡¹ç›®ç»“æ„

```
underwater_target_system/
â”œâ”€â”€ data/                   # ç¤ºä¾‹æ•°æ®é›†ã€é…ç½®
â”œâ”€â”€ models/                 # YOLOv11 æƒé‡ä¸æ¨¡å‹å®šä¹‰
â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ database.py        # æ•°æ®åº“æœåŠ¡
â”‚   â”œâ”€â”€ auth_service.py    # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ inference_service.py  # æ¨ç†æœåŠ¡
â”‚   â”œâ”€â”€ training_service.py   # è®­ç»ƒæœåŠ¡
â”‚   â””â”€â”€ model_manager.py   # æ¨¡å‹ç®¡ç†
â”œâ”€â”€ ui/                     # PyQt6 UI ç›¸å…³
â”‚   â”œâ”€â”€ login/             # ç™»å½•ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ login_window.py
â”‚   â”‚   â””â”€â”€ register_dialog.py
â”‚   â”œâ”€â”€ admin/             # ç®¡ç†å‘˜ä»ªè¡¨ç›˜
â”‚   â”‚   â””â”€â”€ admin_dashboard.py
â”‚   â”œâ”€â”€ main/              # ä¸»ç•Œé¢ï¼ˆæ¨ç†ï¼‰
â”‚   â”‚   â””â”€â”€ main_window.py
â”‚   â”œâ”€â”€ training/          # è®­ç»ƒç®¡ç†
â”‚   â”‚   â””â”€â”€ training_window.py
â”‚   â””â”€â”€ settings/          # ç³»ç»Ÿè®¾ç½®
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°ã€æ—¥å¿—æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ logger.py          # æ—¥å¿—ç®¡ç†
â”œâ”€â”€ logs/                   # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ uploads/                # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”œâ”€â”€ results/                # æ£€æµ‹ç»“æœç›®å½•
â”œâ”€â”€ config.py               # ç³»ç»Ÿé…ç½®
â”œâ”€â”€ main.py                 # ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt        # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- MySQL 5.7+ / 8.0+
- CUDA 11.0+ (å¯é€‰ï¼ŒGPUåŠ é€Ÿ)

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
cd underwater_target_system
```

#### 2. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

#### 3. é…ç½®æ•°æ®åº“

ç¼–è¾‘ `config.py` æ–‡ä»¶ï¼Œä¿®æ”¹æ•°æ®åº“é…ç½®ï¼š

```python
DATABASE_CONFIG = {
    'host': 'localhost',
    'port': 3306,
    'user': 'root',
    'password': 'ä½ çš„å¯†ç ',  # ä¿®æ”¹ä¸ºå®é™…å¯†ç 
    'database': 'underwater_detection',
    'charset': 'utf8mb4'
}
```

**æ³¨æ„**ï¼šé¦–æ¬¡è¿è¡Œæ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“å’Œè¡¨ã€‚

#### 4. å‡†å¤‡ YOLOv11 æ¨¡å‹

å°† YOLOv11 æ¨¡å‹æƒé‡ï¼ˆå¦‚ `yolov11n.pt`ï¼‰æ”¾å…¥ `models/` ç›®å½•ã€‚

å¦‚æœæ²¡æœ‰æ¨¡å‹ï¼Œé¦–æ¬¡è¿è¡Œæ—¶ä¼šè‡ªåŠ¨ä¸‹è½½é»˜è®¤æ¨¡å‹ã€‚

#### 5. è¿è¡Œç¨‹åº

```bash
python main.py
```

## ğŸ“– ä½¿ç”¨è¯´æ˜

### ç™»å½•ç³»ç»Ÿ

1. å¯åŠ¨ç¨‹åºåï¼Œè¿›å…¥ç™»å½•ç•Œé¢
2. ä½¿ç”¨é»˜è®¤è´¦å·ç™»å½•ï¼š
   - ç®¡ç†å‘˜ï¼š`admin` / `admin123`
   - æ™®é€šç”¨æˆ·ï¼š`user` / `user123`
3. æˆ–ç‚¹å‡»"æ³¨å†Œ"åˆ›å»ºæ–°è´¦å·

### æ¨ç†æ£€æµ‹

1. ç™»å½•åè¿›å…¥ä¸»ç•Œé¢
2. åœ¨å·¦ä¾§æ§åˆ¶é¢æ¿é€‰æ‹©æ¨¡å‹å¹¶åŠ è½½
3. è°ƒæ•´ç½®ä¿¡åº¦å’Œ IOU é˜ˆå€¼
4. é€‰æ‹©æ•°æ®æºï¼ˆæ‘„åƒå¤´/å›¾ç‰‡/è§†é¢‘ï¼‰
5. ç‚¹å‡»"å¼€å§‹æ£€æµ‹"
6. æŸ¥çœ‹æ£€æµ‹ç»“æœå¹¶ä¿å­˜

### æ¨¡å‹è®­ç»ƒ

1. ç‚¹å‡»èœå•æ  "å·¥å…·" -> "æ¨¡å‹è®­ç»ƒ"
2. é€‰æ‹©æ•°æ®é›†ç›®å½•ï¼ˆYOLO æ ¼å¼ï¼‰
3. é…ç½®è®­ç»ƒå‚æ•°ï¼ˆepochsã€batch size ç­‰ï¼‰
4. ç‚¹å‡»"å¼€å§‹è®­ç»ƒ"
5. å®æ—¶ç›‘æ§è®­ç»ƒè¿›åº¦å’Œæ—¥å¿—
6. è®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹è‡ªåŠ¨ä¿å­˜åˆ°æ¨¡å‹ä»“åº“

### ç®¡ç†å‘˜åŠŸèƒ½

1. ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•
2. ç‚¹å‡»èœå•æ  "ç®¡ç†" -> "ç®¡ç†å‘˜ä»ªè¡¨ç›˜"
3. ç®¡ç†ç”¨æˆ·ã€æ¨¡å‹ã€æŸ¥çœ‹æ—¥å¿—

## ğŸ”§ æ•°æ®é›†æ ¼å¼

è®­ç»ƒæ•°æ®é›†éœ€éµå¾ª YOLO æ ¼å¼ï¼š

```
dataset/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ img1.jpg
â”‚   â”‚   â””â”€â”€ img2.jpg
â”‚   â””â”€â”€ val/
â”‚       â”œâ”€â”€ img3.jpg
â”‚       â””â”€â”€ img4.jpg
â””â”€â”€ labels/
    â”œâ”€â”€ train/
    â”‚   â”œâ”€â”€ img1.txt
    â”‚   â””â”€â”€ img2.txt
    â””â”€â”€ val/
        â”œâ”€â”€ img3.txt
        â””â”€â”€ img4.txt
```

æ ‡æ³¨æ–‡ä»¶æ ¼å¼ï¼ˆæ¯è¡Œä¸€ä¸ªç›®æ ‡ï¼‰ï¼š
```
<class_id> <x_center> <y_center> <width> <height>
```

## ğŸ“¦ æ‰“åŒ…éƒ¨ç½²

### ä½¿ç”¨ PyInstaller æ‰“åŒ…

#### 1. å®‰è£… PyInstaller

```bash
pip install pyinstaller
```

#### 2. ç”Ÿæˆ .spec æ–‡ä»¶

```bash
pyi-makespec --windowed --name "UnderwaterDetection" main.py
```

#### 3. ç¼–è¾‘ .spec æ–‡ä»¶

ä¿®æ”¹ `UnderwaterDetection.spec`ï¼š

```python
# -*- mode: python ; coding: utf-8 -*-

block_cipher = None

a = Analysis(
    ['main.py'],
    pathex=[],
    binaries=[],
    datas=[
        ('config.py', '.'),
        ('models', 'models'),
        ('data', 'data'),
    ],
    hiddenimports=[
        'PyQt6',
        'ultralytics',
        'pymysql',
        'cv2',
        'numpy',
        'torch',
        'torchvision',
    ],
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    [],
    exclude_binaries=True,
    name='UnderwaterDetection',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    console=False,  # ä¸æ˜¾ç¤ºæ§åˆ¶å°
    disable_windowed_traceback=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
    icon='icon.ico'  # å¯é€‰ï¼šæ·»åŠ å›¾æ ‡
)

coll = COLLECT(
    exe,
    a.binaries,
    a.zipfiles,
    a.datas,
    strip=False,
    upx=True,
    upx_exclude=[],
    name='UnderwaterDetection',
)
```

#### 4. æ‰§è¡Œæ‰“åŒ…

```bash
pyinstaller UnderwaterDetection.spec
```

æ‰“åŒ…å®Œæˆåï¼Œåœ¨ `dist/UnderwaterDetection/` ç›®å½•ä¸‹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚

### æ‰“åŒ…æ³¨æ„äº‹é¡¹

1. **ç¡®ä¿åŒ…å«æ‰€æœ‰ä¾èµ–**ï¼šPyInstaller å¯èƒ½æ— æ³•è‡ªåŠ¨æ£€æµ‹æ‰€æœ‰ä¾èµ–
2. **æ¨¡å‹æ–‡ä»¶**ï¼šç¡®ä¿ YOLOv11 æ¨¡å‹æ–‡ä»¶è¢«åŒ…å«
3. **é…ç½®æ–‡ä»¶**ï¼šæ£€æŸ¥ config.py æ˜¯å¦æ­£ç¡®æ‰“åŒ…
4. **æµ‹è¯•**ï¼šæ‰“åŒ…ååŠ¡å¿…åœ¨å¹²å‡€çš„ç¯å¢ƒä¸­æµ‹è¯•

## âš™ï¸ é…ç½®è¯´æ˜

### config.py ä¸»è¦é…ç½®é¡¹

```python
# æ•°æ®åº“é…ç½®
DATABASE_CONFIG = {
    'host': 'localhost',
    'port': 3306,
    'user': 'root',
    'password': '123456',
    'database': 'underwater_detection',
}

# YOLO é…ç½®
YOLO_CONFIG = {
    'default_model': 'yolov11n.pt',
    'conf_threshold': 0.25,
    'iou_threshold': 0.45,
    'classes': ['fish', 'coral', 'turtle', ...]
}

# è®­ç»ƒé…ç½®
TRAINING_CONFIG = {
    'epochs': 100,
    'batch_size': 16,
    'img_size': 640,
    'lr': 0.01,
}

# ç³»ç»Ÿé…ç½®
SYSTEM_CONFIG = {
    'device': 'cuda',  # cuda / cpu
    'language': 'zh_CN',
    'theme': 'light',
}
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **UIæ¡†æ¶**ï¼šPyQt6
- **æ·±åº¦å­¦ä¹ **ï¼šPyTorch + Ultralytics YOLOv11
- **æ•°æ®åº“**ï¼šMySQL + PyMySQL
- **å›¾åƒå¤„ç†**ï¼šOpenCV
- **æ•°æ®å¤„ç†**ï¼šNumPy, Pandas
- **å¯è§†åŒ–**ï¼šMatplotlib, Seaborn

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

- éµå¾ª PEP 8 è§„èŒƒ
- ç±»å’Œå‡½æ•°åŒ…å«æ–‡æ¡£å­—ç¬¦ä¸²
- ä½¿ç”¨ç±»å‹æ³¨è§£

### æ—¥å¿—è§„èŒƒ

ç³»ç»Ÿä½¿ç”¨åˆ†æ¨¡å—æ—¥å¿—ï¼š
- `system.log` - ç³»ç»Ÿæ—¥å¿—
- `auth.log` - è®¤è¯æ—¥å¿—
- `inference.log` - æ¨ç†æ—¥å¿—
- `training.log` - è®­ç»ƒæ—¥å¿—

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¥ è”ç³»æ–¹å¼

- é¡¹ç›®ç»´æŠ¤è€…ï¼šUnderwater Detection Team
- Email: admin@underwater.com

## ğŸ™ è‡´è°¢

- [Ultralytics YOLOv11](https://github.com/ultralytics/ultralytics)
- [PyQt6](https://www.riverbankcomputing.com/software/pyqt/)
- [OpenCV](https://opencv.org/)

---

**æ³¨æ„**ï¼šæœ¬ç³»ç»Ÿä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚
